function i(e){if(canUseLocalStorage())try{var t=window[e],a="__storage_test__";return t.setItem(a,a),t.removeItem(a),1}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}function t(e){var t=localStorage.getItem(e);if(!t)return null;t=JSON.parse(t);const a=new Date;return a.getTime()>t.expiry?(localStorage.removeItem(e),null):t.value}function e(n){var e;n.hasOwnProperty("key")&&n.hasOwnProperty("url")&&(n.hasOwnProperty("expires")||(n.expires=24),i("localStorage")&&t(n.key)?(d("getting data '"+n.key+"' from local storage","utilities.js"),n.hasOwnProperty("callback")&&"function"==typeof n.callback&&n.callback(JSON.parse(t(n.key)))):(d("getting data '"+n.key+"' from "+n.url,"utilities.js"),(e=new XMLHttpRequest).addEventListener("load",function(){if(i("localStorage")){var e=(new Date).getTime()+60*n.expires*60*1e3;d("storing data '"+n.key+"' in localstorage - expires "+e,"utilities.js");{e=n.key;var t=this.responseText;var a=n.expires;const s=new Date;t={value:t,expiry:s.getTime()+60*a*60*1e3},localStorage.setItem(e,JSON.stringify(t))}}n.hasOwnProperty("callback")&&"function"==typeof n.callback&&n.callback(JSON.parse(this.responseText))}),e.open("GET",n.url),e.send()))}function o(t){for(let e=0;e<spacefinder.spaces.length;e++)if(spacefinder.spaces[e].id==t)return spacefinder.spaces[e]}function r(e,a){for(let t=0;t<spacefinder.filters.length;t++)if(spacefinder.filters[t].key==e){if(void 0===a)return spacefinder.filters[t];for(let e=0;e<spacefinder.filters[t].options.length;e++)if(spacefinder.filters[t].options[e].key==a)return spacefinder.filters[t].options[e]}return!1}function a(e,t){var a;-1!==["filters","list","map"].indexOf(e)&&(a=t?"active":"inactive",t=t?"inactive":"active",document.querySelector('#top-bar .navbutton[data-view="'+e+'"]').classList.remove(t),document.querySelector('#top-bar .navbutton[data-view="'+e+'"]').classList.add(a),document.getElementById(e).classList.remove(t),document.getElementById(e).classList.add(a))}function c(e){""===e&&"pushState"in history?history.pushState("",document.title,window.location.pathname):window.location.hash=e}function d(t,a){if(spacefinder.debug){let e=new Date;console.log(e.getHours()+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")+"."+e.getMilliseconds().toString().padStart(3,"0")+" "+a.padEnd(12)+" - "+t)}}function s(){spacefinder.mapReady&&spacefinder.spacesLoaded&&spacefinder.filtersLoaded&&(d("Setting view","layout.js"),window.innerWidth>=spacefinder.breakpoints.large?(d("Showing filters panel","layout.js"),a("filters",!0)):(d("Hiding filters panel","layout.js"),a("filters",!1)),window.innerWidth>=spacefinder.breakpoints.small&&(d("Showing list panel","layout.js"),a("list",!0)))}function l(){d("getFilterStatus","filters.js");const a=[];for(const i of document.querySelectorAll("#filters input[type=checkbox]"))if(i.checked){var s=i.getAttribute("data-filterkey"),n=i.getAttribute("data-optionkey");let t=!1;if(a.length)for(let e=0;e<a.length;e++)a[e].name==s&&-1==a[e].value.indexOf(n)&&(a[e].value.push(n),t=!0);t||a.push({name:s,value:[n]})}let e=document.getElementById("search-input").value.trim();return 1<e.length&&a.push({name:"search",value:e.split(" ")}),a}function n(){d("applyFilters","spaces.js");const e=l();document.getElementById("listcontainer").scrollTop=0;e.length?(e.forEach(e=>{"search"!==e.name&&document.dispatchEvent(new CustomEvent("sfanalytics",{detail:{type:"filter",filtername:e.name,terms:e.value.join(", ")}}))}),document.querySelectorAll(".list-space").forEach(s=>{s.classList.remove("hidden");let n=!0;e.forEach(a=>{if("search"==a.name){let t=!1;a.value.forEach(e=>{-1!=s.textContent.toLowerCase().indexOf(e.toLowerCase())&&(t=!0)}),t||(n=!1)}else if("open"==a.name)"open"!=s.getAttribute("data-openclass")&&(n=!1);else if(r(a.name).additive){let t=!1;a.value.forEach(e=>{s.classList.contains(a.name+"_"+e)||(t=!0)}),!0===t&&(n=!1)}else{var e=a.name+"_("+a.value.join("|")+")";s.className.match(e)||(n=!1)}}),n||s.classList.add("hidden")})):document.querySelectorAll(".list-space").forEach(e=>{e.classList.remove("hidden")}),document.dispatchEvent(new CustomEvent("spaceDeselected",{bubbles:!0,detail:!1})),document.dispatchEvent(new Event("filtersapplied"))}function p(){d("updateListFilterMessage","spaces.js");let e=l(),t=document.getElementById("listfilters"),a=(t.textContent="",t.setAttribute("hidden",""),filtermessage=resultsmessage="");e.length&&e.forEach(s=>{if("search"==s.name){s.value.length;a="<p>Searching spaces which contain text: ";let t=[];s.value.forEach(e=>{t.push('<button class="search-term icon-remove" data-searchtext="'+e+'">'+e+"</button>")}),a+=t.join(" or ")+"</p>"}else{var e=r(s.name);if(1===e.options.length)filtermessage+='<p><button class="filter-term icon-remove" data-termid="'+s.name+"_"+s.value+'">'+e.message+"</button>";else{filtermessage+="<p>"+e.message;let a=[];s.value.forEach(e=>{var t=r(s.name,e);t&&a.push('<button class="filter-term icon-remove" data-termid="'+s.name+"_"+e+'">'+t.label+"</button>")}),filtermessage+=a.join(e.additive?" and ":" or ")+"</p>"}}});var s=document.querySelectorAll(".list-space").length;let n=s;null!=document.querySelectorAll(".list-space.hidden")&&0==(n-=document.querySelectorAll(".list-space.hidden").length)&&(resultsmessage='<p class="noresults">Sorry, your search has found no results - try removing some of your search criteria.</p>'),a+filtermessage+resultsmessage!=""&&(t.innerHTML=a+filtermessage+resultsmessage,t.removeAttribute("hidden")),document.getElementById("searchResultsSummary").textContent="Showing "+n+" of "+s+" spaces"}function u(e,n){d("selectSpace","spaces.js");var t=o(e),n=(c("/space/"+t.slug),document.dispatchEvent(new CustomEvent("sfanalytics",{detail:{type:"select",id:e,name:t.title,src:n}})),t.id);if(d("renderAdditionalInfo","spaces.js"),document.querySelectorAll(".additionalInfo").forEach(e=>{e.textContent=""}),!1!==n){let a=o(n),e=function(e){return document.querySelector('[data-id="'+e+'"]')}(n),s="",t=(s+='<section class="section-facts"><h3>Key Facts</h3><ul class="bulleticons"><li class="icon-marker switch-view"><a class="show-map" href="#">Show on map</a></li>',"");if(""!==a.floor&&(t+=a.floor+", "),""!==a.building&&(t+=a.building+", "),""!==a.address&&(t+=a.address),t+=' (<a target="googlemaps" href="https://www.google.com/maps/dir/?api=1&amp;destination='+a.lat+"%2c"+a.lng+'&amp;travelmode=walking">get directions</a>)',s+='<li class="icon-address">'+t+"</li>",""!=a.url&&(s+='<li class="icon-link"><a target="spaceurl" href="'+a.url+'">'+a.url+"</a></li>"),""!=a.campusmap_url&&(n=""!==a.campusmap_ref?" (map reference "+a.campusmap_ref+")":"",s+='<li class="icon-uol-logo-mark"><a target="campusmap" href="'+a.campusmap_url+'">View on campus map</a>'+n+"<li>"),a.restricted?(s+='<li class="icon-public">Open to '+a.access,a.restriction&&(s+=" ("+a.restriction+")"),s+="</li>"):s+='<li class="icon-public">Open to '+a.access+"<li>",s=(s=s+"</ul></section>"+'<section class="section-opening"><h3>Opening Times</h3>')+('<p class="icon-time-short" data-openmsg-id="'+a.id+'">'+e.getAttribute("data-openmsg")+"</p>")+'<ul class="opening-times">',["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].forEach((e,t)=>{t=(t+1<7?t+1:0)===(new Date).getDay()?' class="today"':"";a.opening_hours[e].open?s+="<li"+t+'><span class="dayname">'+e.charAt(0).toUpperCase()+e.slice(1)+'</span> <span class="opening">'+a.opening_hours[e].from+" - "+a.opening_hours[e].to+"</span></li>":s+="<li"+t+'><span class="dayname">'+e.charAt(0).toUpperCase()+e.slice(1)+'</span> <span class="opening">Closed</span></li>'}),s+="</ul></section>",""===a.phone_number&&""===a.twitter_screen_name&&""===a.facebook_url||(s+='<section class="section-contact"><h3>Contact</h3><ul class="bulleticons">',""!==a.phone_number&&(n=a.phone_number.replace(/[^0-9]+/g,"").replace(/^0/,"+44"),s+='<li class="icon-phone"><a href="tel:'+n+'">'+a.phone_number+"</a></li>"),""!==a.twitter_screen_name&&(s+='<li class="icon-twitter"><a href="https://twitter.com/'+a.twitter_screen_name+'">'+a.twitter_screen_name+"</a></li>"),""!==a.facebook_url&&(s+='<li class="icon-facebook-squared"><a href="'+a.facebook_url+'">'+a.facebook_url+"</a></li>"),s+="</ul></section>"),a.facilities.length){let t="";a.facilities.forEach(e=>{e=r("facilities",e);e&&(t+='<li class="'+e.icon+'">'+e.label+"</li>")}),""!=t&&(s+='<section class="section-facilities"><h3>Facilities</h3><ul class="bulleticons">'+t+"</ul></section>")}e.querySelector(".additionalInfo").innerHTML=s}let a=document.querySelector('[data-id="'+e+'"]'),s=(document.querySelectorAll(".list-space").forEach(e=>{e.classList.remove("active")}),a.classList.add("active"),a.querySelector("button.space-title").setAttribute("aria-expanded",!0),document.getElementById("listcontainer"));t=document.getElementById("listcontent"),n=document.getElementById("listfilters"),e=a.offsetTop+n.offsetHeight-t.offsetTop;s.scrollTop=e}function m(e){d("deselectSpaces","spaces.js"),document.querySelector(".list-space.active")&&(document.querySelectorAll(".additionalInfo").forEach(e=>{e.textContent=""}),document.querySelectorAll(".list-space").forEach(e=>{e.classList.remove("active")}),document.querySelectorAll("button.space-title").forEach(e=>{e.setAttribute("aria-expanded",!1)}),document.querySelector('.space-title[data-spaceid="'+parseInt(e)+'"]')),c("")}function f(e,t){d("activateSort","spaces.js");const a=document.getElementById("sort"+t);e?(a.disabled=!1,a.addEventListener("click",g)):(a.disabled=!0,a.removeEventListener("click",g))}function g(e){d("sortSpacesListener","spaces.js"),e.preventDefault();var t,a,s,n=e.target.getAttribute("data-sortdir"),i=e.target.getAttribute("id"),n="desc"==n||""==n;"sortalpha"===i&&(a=n?"icon-sort-name-down":"icon-sort-name-up",s=n?"icon-sort-name-up":"icon-sort-name-down",e.target.setAttribute("title",t=n?"Sort alphabetically (descending, z-a)":"Sort alphabetically (ascending, a-z)"),e.target.setAttribute("aria-label",t),e.target.querySelector("span").innerText=t,e.target.classList.remove(s),e.target.classList.add(a)),h(i,n)}function h(e,t){d("sortSpaces","spaces.js"),document.querySelectorAll(".sortbutton").forEach(e=>e.setAttribute("data-sortdir",""));var a=t?"asc":"desc";document.getElementById(e).setAttribute("data-sortdir",a);let s=document.getElementById("listcontent");var n,i,a=document.querySelectorAll("#listcontent>div");let o=Array.prototype.slice.call(a).sort((n=t,i="data-"+e,d("comparer","spaces.js"),function(e,t){var a=(n?e:t).getAttribute(i),t=(n?t:e).getAttribute(i);return e=t,""===(t=a)||""===e||isNaN(t)||isNaN(e)?t.toString().localeCompare(e):t-e}));o.forEach(e=>{s.appendChild(e)}),document.dispatchEvent(new Event("spaceDeselected"))}function v(){d("checkOpeningHours","spaces.js");let e=new Date;let c=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][e.getDay()],l=100*e.getHours()+e.getMinutes();spacefinder.spaces.forEach((e,t)=>{let a="",s="currently-closed";var n=document.querySelector('[data-id="'+e.id+'"]').getAttribute("data-openclass");if(e.opening_hours)if(e.opening_hours[c].open){var i=b(e.opening_hours[c].from),o=b(e.opening_hours[c].to);if(i>l){let e="";var r=(i-l)%60,i=Math.floor((i-l)/60);let t="";0<i&&(t=1==i?"":"s",e+=i+"hr"+t+" "),t=1==r?"":"s",0<r&&(e+=r+"min"+t),a="Currently closed (opens in "+e+")",s="opening-later"}else a=o<l?(s="closed","Currently closed"):(s="open","Currently open")}else a="Closed all day";document.querySelector('[data-id="'+e.id+'"]').setAttribute("data-openmsg",a),document.querySelector('[data-id="'+e.id+'"]').setAttribute("data-openclass",s),null!=document.querySelector('[data-openmsg-id="'+e.id+'"]')&&(document.querySelector('[data-openmsg-id="'+e.id+'"]').textContent=a,document.querySelector('[data-openmsg-id="'+e.id+'"]').classList.remove(n),document.querySelector('[data-openmsg-id="'+e.id+'"]').classList.add(s))})}function b(e){e=e.split(":");return 100*parseInt(e[0])+parseInt(e[1])}function y(){if(d("maybeSetupMap","map.js"),spacefinder.mapLoaded&&spacefinder.spacesLoaded&&spacefinder.filtersLoaded){let t=[];spacefinder.markergroup=L.markerClusterGroup({disableClusteringAtZoom:17,zoomToBoundsOnClick:!0,spiderfyOnMaxZoom:!1,polygonOptions:{color:"#c70000",fillColor:"#c70000"}});for(let e=0;e<spacefinder.spaces.length;e++){var a;spacefinder.spaces[e].lat&&spacefinder.spaces[e].lng&&(a=L.latLng(spacefinder.spaces[e].lat,spacefinder.spaces[e].lng),t.push([spacefinder.spaces[e].lat,spacefinder.spaces[e].lng]),spacefinder.spaces[e].marker=L.marker(a,{alt:spacefinder.spaces[e].title,title:spacefinder.spaces[e].title,icon:L.divIcon({html:'<svg width="32" height="32" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="10" stroke-width="6"></circle></svg>',className:"space-marker",iconSize:[32,32],iconAnchor:[16,16]})}),spacefinder.markergroup.addLayer(spacefinder.spaces[e].marker),spacefinder.spaces[e].popup=L.popup().setContent(function(e){let t=[];t.push(e.space_type),""!==e.floor&&t.push(e.floor);""!==e.building&&t.push(e.building);var a='<div class="spaceInfoWindow"><h3>'+e.title+"</h3>";return a=(a+='<p class="info">'+t.join(", ")+"</p>")+'<p class="description">'+e.description+'</p><button class="show-list">More info&hellip;</button></div>'}(spacefinder.spaces[e])),spacefinder.spaces[e].popup.spaceID=spacefinder.spaces[e].id,spacefinder.spaces[e].marker.bindPopup(spacefinder.spaces[e].popup))}spacefinder.map.addLayer(spacefinder.markergroup),spacefinder.map.on("popupopen",e=>{E(e.popup.spaceID),document.dispatchEvent(new CustomEvent("spaceSelectedOnMap",{bubbles:!0,detail:{id:e.popup.spaceID,src:"map"}}))}),spacefinder.map.on("popupclose",e=>{document.dispatchEvent(new CustomEvent("spaceDeselectedFromMap",{bubbles:!0,detail:{id:e.popup.spaceID}}))}),document.addEventListener("spaceSelected",e=>{E(e.detail.id)}),document.addEventListener("spaceDeselected",w),t.length&&spacefinder.map.fitBounds(t),spacefinder.mapBounds=spacefinder.map.getBounds(),spacefinder.mapZoom=parseInt(spacefinder.map.getZoom()),L.Control.mapTypeControl=L.Control.extend({onAdd:function(e){var t=spacefinder.viewdata.satellite;const a=document.createElement("button");return a.innerHTML=t.btnText,a.classList.add("maptype-button"),a.classList.add(t.btnClass),a.setAttribute("aria-label",t.btnLabel),a.setAttribute("title",t.btnLabel),a.setAttribute("data-currentType","street"),a},onRemove:function(e){}}),L.control.mapTypeControl=function(e){return new L.Control.mapTypeControl(e)},L.control.mapTypeControl({position:"topright"}).addTo(spacefinder.map),document.addEventListener("click",t=>{if(t.target.matches(".maptype-button")){var t=t.target.getAttribute("data-currentType"),a="street"==t?"satellite":"street";let e=document.querySelector("button.maptype-button");e&&(e.classList.replace(spacefinder.viewdata[a].btnClass,spacefinder.viewdata[t].btnClass),e.innerHTML=spacefinder.viewdata[t].btnText,e.setAttribute("aria-label",spacefinder.viewdata[t].btnLabel),e.setAttribute("title",spacefinder.viewdata[t].btnLabel),e.setAttribute("data-currentType",a),spacefinder.viewdata[t].tileLayer.removeFrom(spacefinder.map),spacefinder.viewdata[a].tileLayer.addTo(spacefinder.map))}}),spacefinder.mapReady=!0,document.dispatchEvent(new Event("sfmapready"))}}function E(e){d("zoomMapToSpace","map.js");let t=o(e);e=L.latLng(t.lat,t.lng);t.popup.setLatLng(e).openOn(spacefinder.map),spacefinder.map.setView(e,18)}function w(){d("deselectSpacesFromMap","map.js"),spacefinder.map.closePopup()}function S(){d("filterMarkers","map.js");let a=[];document.querySelectorAll(".list-space").forEach(e=>{var t=o(e.getAttribute("data-id"));e.classList.contains("hidden")||a.push(t.marker)}),spacefinder.markergroup.clearLayers(),spacefinder.markergroup.addLayers(a)}function A(e){d("toggleGeolocation","map.js"),e?document.querySelectorAll(".geo-button").forEach(e=>e.disabled=!1):document.querySelectorAll(".geo-button").forEach(e=>e.disabled=!0)}function k(e){d("activateGeolocation","map.js"),e?(document.querySelectorAll(".geo-button").forEach(e=>{e.classList.add("active"),e.setAttribute("aria-label","Stop using my location"),e.setAttribute("title","Stop using my location")}),document.addEventListener("userlocationchanged",C),document.dispatchEvent(new CustomEvent("sfanalytics",{detail:{type:"geostart"}}))):(document.querySelectorAll(".geo-button").forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-label","Use my location"),e.setAttribute("title","Use my location")}),document.removeEventListener("userlocationchanged",C),document.getElementById("sortdistance").setAttribute("data-sortdir",""),document.dispatchEvent(new CustomEvent("sfanalytics",{detail:{type:"geoend"}}))),x(),f(e,"distance")}function C(){d("movePersonMarker","map.js"),spacefinder.personMarker&&spacefinder.personMarker.setPosition(spacefinder.personLoc),x(),null!==document.querySelector('#sortdistance[data-sortdir$="sc"')&&h("sortdistance","desc"!=document.getElementById("sortdistance").getAttribute("data-sortdir")),spacefinder.map.panTo(spacefinder.personLoc)}function I(){return d("geolocationActive","map.js"),null!==document.querySelector(".geo-button.active")}function _(){d("checkGeo","map.js"),d("checkGeoAvailable","map.js"),"geolocation"in navigator?(L.Control.geoControl=L.Control.extend({onAdd:function(e){const t=document.createElement("button");return t.innerHTML="",t.classList.add("geo-button"),t.classList.add("icon-my-location"),t.setAttribute("aria-label","Use my location"),t.setAttribute("title","Use my location"),t},onRemove:function(e){}}),L.control.geoControl=function(e){return new L.Control.geoControl(e)},L.control.geoControl({position:"topright"}).addTo(spacefinder.map),document.addEventListener("click",e=>{e.target.matches(".geo-button")&&(d("geolocationEnabled","map.js"),null!==(e=document.querySelector(".geo-button"))&&0==e.disabled&&(I()?(d("forgetUserPosition","map.js"),navigator.geolocation.clearWatch(spacefinder.watchID),spacefinder.personMarker.remove(),k(!1),spacefinder.map.panTo(spacefinder.currentLoc)):(d("getUserPosition","map.js"),navigator.geolocation.getCurrentPosition(t=>{if(spacefinder.personLoc.lat=t.coords.latitude,spacefinder.personLoc.lng=t.coords.longitude,spacefinder.mapBounds.contains(spacefinder.personLoc))spacefinder.map.panTo(spacefinder.personLoc),spacefinder.personMarker=L.marker(spacefinder.personLoc,{alt:"Your location"}).addTo(spacefinder.map),k(!0),spacefinder.watchID=navigator.geolocation.watchPosition(e=>{spacefinder.personLoc.lat==e.coords.latitude&&spacefinder.personLoc.lng==e.coords.longitude||(spacefinder.personLoc.lat=e.coords.latitude,spacefinder.personLoc.lng=e.coords.longitude,document.dispatchEvent(new Event("userlocationchanged")))},e=>{navigator.geolocation.clearWatch(spacefinder.watchID),k(!1)});else{A(!1);{var t="Sorry...",a="You need to be a bit nearer to use this feature.";document.getElementById("sfalertdialog-title").textContent=t,document.getElementById("sfalertdialog-description").innerHTML=a;let e=new A11yDialog(document.getElementById("sfalertdialog"));e.show(),e.on("hide",(e,t)=>{document.getElementById("sfalertdialog-title").textContent="Dialog title",document.getElementById("sfalertdialog-description").textContent="Dialog description"})}}},e=>{switch(k(!1),e.code){case 1:case 2:A(!1)}}))))})):(k(!1),A(!1)),d("checkGeoPermissions","map.js"),"permissions"in navigator&&navigator.permissions.query&&navigator.permissions.query({name:"geolocation"}).then(e=>{spacefinder.permission=e.state,"denied"==e.state?A(!1):A(!0),e.onchange=function(){spacefinder.permission=e.state,"denied"==e.state?A(!1):A(!0)}}).catch(e=>{A(!1)})}function x(){if(d("updateDistances","map.js"),I())spacefinder.spaces.forEach((e,t)=>{var a,s,n,i,o;spacefinder.spaces[t].distancefromcentre=(a=spacefinder.personLoc,s={lat:e.lat,lng:e.lng},n=a.lat*(Math.PI/180),i=s.lat*(Math.PI/180),o=i-n,s=(s.lng-a.lng)*(Math.PI/180),a=12742142*Math.asin(Math.sqrt(Math.sin(o/2)*Math.sin(o/2)+Math.cos(n)*Math.cos(i)*Math.sin(s/2)*Math.sin(s/2))),Math.round(a)),document.querySelector('[data-id="'+e.id+'"]').setAttribute("data-sortdistance",spacefinder.spaces[t].distancefromcentre)});else{let e=document.querySelectorAll(".list-space");null!==e&&e.forEach(e=>e.setAttribute("data-sortdistance",""))}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("#top-bar .navbutton").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),document.getElementById("top-bar").dispatchEvent(new CustomEvent("viewchange",{bubbles:!0,cancelable:!0,composed:!1,detail:{view:t.getAttribute("data-view")}}))})}),document.addEventListener("viewchange",e=>{document.getElementById(e.detail.view);"filters"==e.detail.view&&document.querySelector('#top-bar .navbutton[data-view="filters"]').classList.contains("active")?(a("filters",!1),a("list",!0)):(["filters","list","map"].forEach(e=>{a(e,!1)}),a(e.detail.view,!0),"filters"==e.detail.view&&window.setTimeout(function(){document.getElementById("search-input").focus()},1e3))}),document.addEventListener("spacesloaded",s),document.addEventListener("sfmapready",s),document.addEventListener("filtersloaded",s),document.addEventListener("sfresize",s),window.addEventListener("resize",()=>{clearTimeout(spacefinder.resizeTimeout),spacefinder.resizeTimeout=setTimeout(()=>{d("Resize event","layout.js"),document.dispatchEvent(new Event("sfresize"))},200)})}),document.addEventListener("spacesloaded",()=>{document.addEventListener("filtersloaded",()=>{if(d("renderFilters","filters.js"),spacefinder.filters.length){let e=document.createElement("form"),t=(e.setAttribute("id","filter-options-form"),e.setAttribute("role","search"),e.setAttribute("aria-label","Search and filter spaces"),document.createElement("div")),o=(t.classList.add("top-controls"),t.innerHTML='<div><label for="search-input" class="visuallyhidden">Search</label><input id="search-input" type="search" placeholder="Search"></div><div class="searchbuttons"><button type="reset" id="search-reset" class="btn" disabled>Reset</button><button type="submit" id="search-submit" class="btn" aria-controls="searchResultsSummary" disabled>Search</button></div></div>',e.appendChild(t),document.createElement("div"));o.classList.add("panel-content"),spacefinder.filters.forEach(a=>{let e=document.createElement("fieldset"),t=(e.classList.add("filter-options"),e.classList.add(a.key+"-filter-options"),document.createElement("legend")),s=document.createElement("ul"),n=(s.setAttribute("id","filters-"+a.key),1===a.options.length?(t.classList.add("visuallyhidden"),t.appendChild(document.createTextNode(a.label))):(e.classList.add("accordion"),t.innerHTML='<button type="button" class="accordion-trigger" id="trigger-'+a.key+'" aria-controls="filters-'+a.key+'" aria-expanded="'+(a.open?"true":"false")+'" tabindex="0"><span>'+a.label+"</span></button>",s.classList.add("accordion-content"),s.setAttribute("aria-hidden",a.open?"false":"true"),s.setAttribute("aria-labelledby","trigger-"+a.key),a.open||s.setAttribute("hidden","")),e.appendChild(t),""),i=a.exclusive?' class="exclusive"':"";a.options.forEach(e=>{n=(n+='<li class="filter-option '+a.key+" "+a.key+"_"+e.key+'" data-id="'+a.key+"_"+e.key+'">')+'<input type="checkbox" data-filterkey="'+a.key+'" data-optionkey="'+e.key+'" id="'+a.key+"_"+e.key+'" name="'+a.key+"_"+e.key+'" value="'+a.key+"_"+e.key+'"'+i+">";var t=e.icon||"icon-tick";n=n+('<span class="'+t+'"></span><label for="'+a.key+"_"+e.key+'">'+e.label)+"</label></li>"}),s.innerHTML=n,e.appendChild(s),o.appendChild(e)}),e.appendChild(o),document.getElementById("filters").appendChild(e),document.dispatchEvent(new Event("filtersrendered"))}{var e;d("setupFilters","filters.js"),document.addEventListener("filtersapplied",e=>{l().length?(document.getElementById("search-reset").removeAttribute("disabled"),document.getElementById("search-submit").removeAttribute("disabled")):document.getElementById("search-input").value.trim().length<2&&(document.getElementById("search-reset").setAttribute("disabled",""),document.getElementById("search-submit").setAttribute("disabled",""))});for(const a of document.querySelectorAll("#filters input[type=checkbox]"))a.addEventListener("focus",e=>{e.target.closest("li").classList.add("focus")}),a.addEventListener("blur",e=>{document.querySelectorAll("#filters li").forEach(e=>e.classList.remove("focus"))}),a.addEventListener("change",e=>{const t=e.target;if(t.matches(".exclusive")){e=t.checked;for(const a of t.closest("ul").querySelectorAll("input[type=checkbox].exclusive"))a.checked=!1;t.checked=e}t.dispatchEvent(new Event("viewfilter",{bubbles:!0}))});document.getElementById("search-reset").addEventListener("click",e=>{e.preventDefault(),document.getElementById("filter-options-form").reset();for(const t of document.querySelectorAll("#filters input[type=checkbox]"))t.checked=!1;e.target.dispatchEvent(new Event("viewfilter",{bubbles:!0}))}),document.getElementById("search-input").addEventListener("input",e=>{var t=document.getElementById("search-input").value.trim();1<t.length?(document.getElementById("search-reset").removeAttribute("disabled"),document.getElementById("search-submit").removeAttribute("disabled")):(null==document.querySelectorAll("#filters input[type=checkbox]:checked")&&(document.getElementById("search-reset").setAttribute("disabled",""),document.getElementById("search-submit").setAttribute("disabled","")),0==t.length&&e.target.dispatchEvent(new Event("viewfilter",{bubbles:!0})))}),document.getElementById("search-submit").addEventListener("click",e=>{e.preventDefault();var t=document.getElementById("search-input").value.replace(/[^a-zA-Z0-9 ]/g,"").trim();d(t,"filters.js"),1<t.length&&(document.getElementById("search-input").value=t,e.target.dispatchEvent(new Event("viewfilter",{bubbles:!0})),document.dispatchEvent(new CustomEvent("sfanalytics",{detail:{type:"search",terms:t}}))),document.getElementById("top-bar").dispatchEvent(new CustomEvent("viewchange",{bubbles:!0,cancelable:!0,composed:!1,detail:{view:"list"}}))});const t=document.querySelectorAll(".accordion");t.forEach(e=>{new B(e)})}}),d("loadFilters","filters.js"),e({key:"filters",url:spacefinder.filtersurl,callback:e=>{e.length&&(spacefinder.filters=e,spacefinder.filtersLoaded=!0,document.dispatchEvent(new Event("filtersloaded")))}})}),document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("spacesloaded",()=>{{d("renderList","spaces.js");let s=document.getElementById("listcontent"),e=spacefinder.spaces.length;spacefinder.spaces.forEach(e=>{(spaceContainer=document.createElement("div")).setAttribute("data-id",e.id),spaceContainer.setAttribute("data-sortalpha",e.sortKey),spaceContainer.setAttribute("class",e.classes);let t='<div class="space-summary"><h2><button data-slug="'+e.slug+'" class="accordion-trigger space-title load-info" aria-expanded="false" aria-controls="additionalInfo'+e.id+'" data-spaceid="'+e.id+'">'+e.title+"</button></h2>",a=(t=t+('<p class="space-info"><span class="space-type space-type-'+e.space_type.replace(/[^0-9a-zA-Z]/g,"").toLowerCase()+'">'+e.space_type+"</span>")+'<span class="distance">(1,353 metres)</span>',"");""!==e.floor&&(a+='<span class="address-floor">'+e.floor+"</span>, "),""!==e.building&&(a+='<span class="address-building">'+e.building+"</span>, "),""!==e.address&&(a+='<span class="address-location">'+e.address+"</span>"),t=t+('<span class="address">'+a)+'</span></p><div class="space-details">',""!=e.image&&(t+='<div data-imgsrc="'+e.image+'" class="space-image lazy" role="img" aria-label="'+e.imagealt+'"></div>'),t=(t+='<p class="description">'+e.description+"</p></div></div>")+'<div class="additionalInfo" id="additionalInfo'+e.id+'"></div></div>',spaceContainer.innerHTML=t,s.append(spaceContainer)}),document.getElementById("searchResultsSummary").innerHTML="Showing "+e+" of "+e+" spaces"}var e,t;if(d("lazyLoadSpaceImages","spaces.js"),"IntersectionObserver"in window){e=document.querySelectorAll(".lazy");const s=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&((e=e.target).classList.remove("lazy"),e.setAttribute("style","background-image:url("+spacefinder.imageBaseURL+e.getAttribute("data-imgsrc")+")"),s.unobserve(e))})});e.forEach(function(e){s.observe(e)})}else{function a(){t&&clearTimeout(t),t=setTimeout(function(){e.forEach(function(e){e.offsetTop<window.innerHeight+window.pageYOffset&&(e.src=e.dataset.src,e.classList.remove("lazy"),image.setAttribute("style","background-image:url("+spacefinder.imageBaseURL+image.getAttribute("data-imgsrc")+")"))}),0==e.length&&(document.removeEventListener("scroll",a),window.removeEventListener("resize",a),window.removeEventListener("orientationChange",a))},20)}e=document.querySelectorAll(".lazy"),document.addEventListener("scroll",a),window.addEventListener("resize",a),window.addEventListener("orientationChange",a)}x(),v(),setInterval(v,3e4),f(!0,"alpha")}),d("loadSpaces","spaces.js"),e({key:"spaces",url:spacefinder.spacesurl,callback:e=>{e.length&&(e.forEach((e,t)=>{spacefinder.spaces[t]=e,spacefinder.spaces[t].link="#/space/"+e.slug,spacefinder.spaces[t].classes=function(e){var t="list-space ";e.space_type&&(t+="space_type_"+e.space_type.replace(/[^0-9a-zA-Z]/g,"").toLowerCase()+" ");e.work.length&&(t+="work_"+e.work.join(" work_")+" ");e.facilities.length&&(t+="facilities_"+e.facilities.join(" facilities_")+" ");e.atmosphere.length&&(t+="atmosphere_"+e.atmosphere.join(" atmosphere_")+" ");e.noise&&(t+="noise_"+e.noise.replace(/\W/g,"").toLowerCase());return t}(e),spacefinder.spaces[t].sortKey=e.title.replace(/[^0-9a-zA-Z]/g,"").toLowerCase()}),spacefinder.spaces.sort((e,t)=>e.sortKey<t.sortKey?-1:e.sortKey>t.sortKey?1:0),spacefinder.spacesLoaded=!0,document.getElementById("list").dispatchEvent(new Event("spacesloaded",{bubbles:!0,cancelable:!0,composed:!1})))}}),document.addEventListener("viewfilter",n),document.addEventListener("filtersapplied",p),document.addEventListener("spaceSelected",e=>{u(e.detail.id,e.detail.src)}),document.addEventListener("spaceDeselected",e=>{m(e.detail)}),document.addEventListener("spaceSelectedOnMap",e=>{u(e.detail.id,"map")}),document.addEventListener("spaceDeselectedFromMap",e=>{m(e.detail)}),document.addEventListener("click",n=>{if(n.target.classList.contains("show-map"))n.preventDefault(),document.dispatchEvent(new CustomEvent("viewchange",{bubbles:!0,cancelable:!0,composed:!1,detail:{view:"map"}}));else if(n.target.classList.contains("load-info"))if(n.preventDefault(),"true"===n.target.getAttribute("aria-expanded")){var t=n.target.getAttribute("data-spaceid");document.dispatchEvent(new CustomEvent("spaceDeselected",{bubbles:!0,detail:t})),n.target.setAttribute("aria-expanded","false"),c("")}else{t=n.target.getAttribute("data-spaceid");let e=document.querySelector('[data-id="'+t+'"]');e.classList.contains("active")||document.dispatchEvent(new CustomEvent("spaceSelected",{bubbles:!0,detail:{id:t,src:"list"}})),n.target.setAttribute("aria-expanded","true")}else if(n.target.classList.contains("search-term")){n.preventDefault();let t=n.target.getAttribute("data-searchtext"),e=document.getElementById("search-input").value.trim(),a=e.split(" "),s=[];a.forEach(e=>{e!=t&&s.push(e)}),document.getElementById("search-input").value=s.join(" "),document.dispatchEvent(new Event("viewfilter",{bubbles:!0}))}else n.target.classList.contains("filter-term")&&(n.preventDefault(),t=n.target.getAttribute("data-termid"),document.getElementById(t).checked=!1,document.dispatchEvent(new Event("viewfilter",{bubbles:!0})))})}),document.addEventListener("DOMContentLoaded",()=>{d("initMap","map.js"),document.addEventListener("sfmaploaded",_),document.addEventListener("filtersapplied",S),document.addEventListener("spacesloaded",y),document.addEventListener("filtersloaded",y),document.addEventListener("sfmaploaded",y),spacefinder.map=L.map("map").setView([spacefinder.currentLoc.lat,spacefinder.currentLoc.lng],spacefinder.startZoom),spacefinder.osm=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'© <a target="external" href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(spacefinder.map),spacefinder.esri_sat=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:19,attribution:"Tiles © Esri - Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),spacefinder.map.addControl(new L.Control.Fullscreen({position:"topright"})),spacefinder.mapLoaded=!0,spacefinder.viewdata={street:{btnText:"Street",btnLabel:"Switch to Street View",btnClass:"maptype-street",tileLayer:spacefinder.osm},satellite:{btnText:"Satellite",btnLabel:"Switch to Satellite View",btnClass:"maptype-satellite",tileLayer:spacefinder.esri_sat}},document.dispatchEvent(new Event("sfmaploaded")),document.addEventListener("click",e=>{e.target.classList.contains("show-list")&&(e.preventDefault(),document.dispatchEvent(new CustomEvent("viewchange",{bubbles:!0,cancelable:!0,composed:!1,detail:{view:"list"}}))),(e.target.classList.contains("leaflet-popup-close-button")||e.target.parentNode.classList.contains("leaflet-popup-close-button"))&&e.preventDefault()}),document.addEventListener("sfresize",()=>{spacefinder.map.invalidateSize(!0)}),document.addEventListener("viewchange",()=>{d("view changed","map.js"),window.setTimeout(()=>{d("invalidating map size - viewchange event","map.js"),spacefinder.map.invalidateSize(!0)},500)})}),document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("sfmapready",e=>{if(window.location.hash){var t=window.location.hash.split("/");if(3===t.length)if("space"==t[1]&&(a=function(t){for(let e=0;e<spacefinder.spaces.length;e++)if(spacefinder.spaces[e].slug==t)return spacefinder.spaces[e]}(t[2]),document.dispatchEvent(new CustomEvent("spaceSelected",{bubbles:!0,detail:{id:a.id,src:"load"}}))),"page"==t[1]){var a=document.getElementById(t[2]+"-page");if(null!==a){let e=new A11yDialog(a);e.show(),e.on("hide",(e,t)=>{c("")})}}}})}),document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("sfanalytics",e=>{"function"==typeof gtag&&("search"==e.detail.type?gtag("event","search",{search_term:e.detail.terms}):"filter"==e.detail.type?gtag("event","select_content",{content_type:e.detail.filtername,item_id:e.detail.terms}):"geostart"==e.detail.type?gtag("event","level_start",{level_name:"Geolocation activated"}):"geoend"==e.detail.type?gtag("event","level_end",{level_name:"Geolocation deactivated"}):"select"==e.detail.type&&gtag("event","select_item",{item_list_id:e.detail.src,item_list_name:e.detail.src,items:[{item_id:e.detail.id,item_name:e.detail.name}]}))})});"use strict";class B{constructor(e){this.rootEl=e,this.buttonEl=this.rootEl.querySelector("button[aria-expanded]");e=this.buttonEl.getAttribute("aria-controls");this.contentEl=document.getElementById(e),this.open="true"===this.buttonEl.getAttribute("aria-expanded"),this.buttonEl.addEventListener("click",this.onButtonClick.bind(this))}onButtonClick(e){e.preventDefault(),this.toggle(!this.open)}toggle(e){e!==this.open&&(this.open=e,this.buttonEl.setAttribute("aria-expanded",e?"true":"false"),e?this.contentEl.removeAttribute("hidden"):this.contentEl.setAttribute("hidden",""))}open(){this.toggle(!0)}close(){this.toggle(!1)}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".modal-trigger").forEach(e=>{var t=e.getAttribute("data-dialogid");let a=e.getAttribute("data-dialoghash"),s=new A11yDialog(document.getElementById(t));e.addEventListener("click",e=>{s.show(),s.originalpagehash=window.location.hash,window.location.hash="#/page/"+a,document.dispatchEvent(new CustomEvent("sfanalytics",{detail:{type:"select",id:a,name:e.target.textContent}}))}),s.on("hide",(e,t)=>{window.location.hash=s.originalpagehash})})});